/// Sorted Priority
/// table has two columns: "Review Priority" and "Review Name," which are used to categorize and label priority levels for reviews.
expression 'Sorted Priority' =
		let
		    #"Updated JMS Table" = let
		    Source = SharePoint.Tables("https://kbsmaritime.sharepoint.com/sites/JointManagementSystem", [ApiVersion = 15]),
		    #"7a204d33-f1a5-4660-9105-822ef3cfee94" = Source{[Id="7a204d33-f1a5-4660-9105-822ef3cfee94"]}[Items],
		    #"Renamed Columns" = Table.RenameColumns(#"7a204d33-f1a5-4660-9105-822ef3cfee94",{{"ID", "ID.1"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"CheckoutUser"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"ServerRedirectedEmbedUri", "Document Link"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns1",{"ServerRedirectedEmbedUrl", "ContentTypeId", "FileSystemObjectType", "ComplianceAssetId"}),
		    #"Filtered Rows" = Table.SelectRows(#"Removed Columns1", each ([Title] <> null)),
		    #"Removed Columns2" = Table.RemoveColumns(#"Filtered Rows",{"DocumentOwnerId", "DocumentOwnerStringId", "MethodStatementServiceDeliveryPlan", "OData__Copyright"}),
		    #"Extracted Date" = Table.TransformColumns(#"Removed Columns2",{{"ReviewDate", DateTime.Date, type date}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Extracted Date",{"URL", "External Ref. Type", "Mgt. Plan Type", "Standard Type", "Strategy Type", "OData__ColorTag", "VControlTableAdded"}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Removed Columns3",{"Mgt. System", "Process AuthorityId", "Process AuthorityStringId", "AuthorId", "OData__CopySource", "CheckoutUserId", "OData__UIVersionString", "GUID", "FirstUniqueAncestorSecurableObject", "RoleAssignments", "AttachmentFiles"}),
		    #"Expanded ContentType" = Table.ExpandRecordColumn(#"Removed Columns4", "ContentType", {"Name"}, {"ContentType.Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Expanded ContentType",{{"ContentType.Name", "Content Type"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns3",{"GetDlpPolicyTip"}),
		    #"Expanded FieldValuesAsHtml" = Table.ExpandRecordColumn(#"Removed Columns5", "FieldValuesAsHtml", {"FileLeafRef", "Title"}, {"FieldValuesAsHtml.FileLeafRef", "FieldValuesAsHtml.Title"}),
		    #"Split Column by Delimiter" = Table.SplitColumn(#"Expanded FieldValuesAsHtml", "FieldValuesAsHtml.FileLeafRef", Splitter.SplitTextByDelimiter("-", QuoteStyle.Csv), {"FieldValuesAsHtml.FileLeafRef.1", "FieldValuesAsHtml.FileLeafRef.2", "FieldValuesAsHtml.FileLeafRef.3", "FieldValuesAsHtml.FileLeafRef.4"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"FieldValuesAsHtml.FileLeafRef.1", Int64.Type}, {"FieldValuesAsHtml.FileLeafRef.2", type text}, {"FieldValuesAsHtml.FileLeafRef.3", type text}, {"FieldValuesAsHtml.FileLeafRef.4", type text}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type",{{"FieldValuesAsHtml.FileLeafRef.1", "JMS ID"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns4",{"FieldValuesAsHtml.FileLeafRef.2", "FieldValuesAsHtml.FileLeafRef.3", "FieldValuesAsHtml.FileLeafRef.4"}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Removed Columns6",{{"FieldValuesAsHtml.Title", "Document Title"}}),
		    #"Expanded Process Authority" = Table.ExpandRecordColumn(#"Renamed Columns5", "Process Authority", {"Title"}, {"Process Authority.Title"}),
		    #"Renamed Columns6" = Table.RenameColumns(#"Expanded Process Authority",{{"Process Authority.Title", "Process Authority"}}),
		    #"Removed Columns7" = Table.RemoveColumns(#"Renamed Columns6",{"ParentIDLookup", "ID.1", "EditorId"}),
		    #"Removed Columns8" = Table.RemoveColumns(#"Removed Columns7",{"Author", "Editor", "JMSIDLookup", "SharedWithUsers", "TaxCatchAll", "Additional Authorisers"}),
		    #"Expanded DocumentOwner" = Table.ExpandRecordColumn(#"Removed Columns8", "DocumentOwner", {"Title"}, {"DocumentOwner.Title"}),
		    #"Renamed Columns7" = Table.RenameColumns(#"Expanded DocumentOwner",{{"DocumentOwner.Title", "Document Owner"}}),
		    #"Removed Columns9" = Table.RemoveColumns(#"Renamed Columns7",{"Additional AuthorisersId", "Additional AuthorisersStringId", "Eng. Auth. Req'd?", "SHE Auth. Req'd?", "SharedWithUsersId", "SharedWithDetails", "IM Auth. Req'd?", "JMSIDLookupId", "ParentIDLookupId"}),
		    #"Filtered Rows1" = Table.SelectRows(#"Removed Columns9", each true),
		    #"Removed Columns10" = Table.RemoveColumns(#"Filtered Rows1",{"Created", "Modified"}),
		    #"Expanded FieldValuesAsText" = Table.ExpandRecordColumn(#"Removed Columns10", "FieldValuesAsText", {"ProcessID_x003A_Procedure"}, {"FieldValuesAsText.ProcessID_x003A_Procedure"}),
		    #"Renamed Columns8" = Table.RenameColumns(#"Expanded FieldValuesAsText",{{"FieldValuesAsText.ProcessID_x003A_Procedure", "Parent Documrnt Filter"}}),
		    #"Removed Columns11" = Table.RemoveColumns(#"Renamed Columns8",{"JMSReadyTBCComments", "ReviewPeriod", "FieldValuesForEdit", "File", "Folder", "LikedByInformation", "ParentList", "Properties", "Versions"}),
		    #"Added Custom" = Table.AddColumn(#"Removed Columns11", "Days till Review", each DateTime.From([ReviewDate]) - DateTime.LocalNow()),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Added Custom",{{"Days till Review", Int64.Type}}),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Changed Type4",{{"ReviewDate", type datetime}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Changed Type3",{{"Days till Review", type duration}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type2",{{"ReviewDate", type date}, {"Days till Review", Int64.Type}}),
		    #"Added Custom1" = Table.AddColumn(#"Changed Type1", "Status", each if [Days till Review] < 0 then "Expired"
		  else if [Days till Review] >= 0 and [Days till Review] < 30 then "Expires within 30 Days"
		  else if [Days till Review] >= 30 and [Days till Review] < 60 then "Expires within 60 Days"
		  else if [Days till Review] >= 60 and [Days till Review] < 180 then "Expires within 180 Days"
		  else "Expires within 180+ Days"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom1",{{"Status", "Review Status"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns9", "Custom", each if [Days till Review] < 0 then "Review Overdue"
		  else if [Days till Review] >= 0 and [Days till Review] < 30 then "Review within 30 Days"
		  else if [Days till Review] >= 30 and [Days till Review] < 60 then "Review within 60 Days"
		  else if [Days till Review] >= 60 and [Days till Review] < 90 then "Review within 90 Days"
		  else if [Days till Review] < 365 then "Review within 1 year"
		  else "Greater than 1 year"),
		    #"Renamed Columns10" = Table.RenameColumns(#"Added Custom2",{{"Custom", "Review Priorty"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns10", "Custom", each if [JMS ID] >= 10000 and [JMS ID] <= 10999 then "10K"
		  else if [JMS ID] >= 15000 and [JMS ID] <= 15999 then "15K"
		  else if [JMS ID] >= 30000 then "30K"
		  else null),
		    #"Renamed Columns11" = Table.RenameColumns(#"Added Custom3",{{"Custom", "10k or 30K"}}),
		    #"Duplicated Column" = Table.DuplicateColumn(#"Renamed Columns11", "Review Status", "Review Status - Copy")
		in
		    #"Renamed Columns11",
		    #"Filtered Rows" = Table.SelectRows(#"Updated JMS Table", each ([ReviewDate] <> null)),
		    #"Duplicated Column" = Table.DuplicateColumn(#"Filtered Rows", "Review Status", "Review Status - Copy"),
		    #"Replaced Value" = Table.ReplaceValue(#"Duplicated Column","Expires within 180+ Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","Expires within 60 Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Expires within 180 Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","Expires within 30 Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Replaced Value3",{{"Review Status - Copy", "Compliant and Expired"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"Compliant and Expired", type text}}),
		    #"Duplicated Column1" = Table.DuplicateColumn(#"Changed Type", "Compliant and Expired", "Compliant and Expired - Copy"),
		    #"Replaced Value4" = Table.ReplaceValue(#"Duplicated Column1","Compliant","2",Replacer.ReplaceText,{"Compliant and Expired - Copy"}),
		    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","Expired","1",Replacer.ReplaceText,{"Compliant and Expired - Copy"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value5",{{"Compliant and Expired - Copy", Int64.Type}}),
		    #"Merged Queries" = Table.NestedJoin(#"Changed Type1", {"Review Status"}, #"Sorted Rows", {"Review Status"}, "Sorted Rows", JoinKind.LeftOuter),
		    #"Expanded Sorted Rows" = Table.ExpandTableColumn(#"Merged Queries", "Sorted Rows", {"Priority"}, {"Sorted Rows.Priority"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Expanded Sorted Rows",{{"Sorted Rows.Priority", "Prioity"}}),
		    #"Duplicated Column2" = Table.DuplicateColumn(#"Renamed Columns1", "Document Owner", "Document Owner - Copy"),
		    #"Duplicated Column3" = Table.DuplicateColumn(#"Duplicated Column2", "Process Authority", "Process Authority - Copy"),
		    #"Split Column by Delimiter" = Table.SplitColumn(#"Duplicated Column3", "Document Owner", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, true), {"Document Owner.1", "Document Owner.2"}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"Document Owner.1", type text}, {"Document Owner.2", type text}}),
		    #"Split Column by Delimiter1" = Table.SplitColumn(#"Changed Type2", "Document Owner.1", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, true), {"Document Owner.1.1", "Document Owner.1.2"}),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Split Column by Delimiter1",{{"Document Owner.1.1", type text}, {"Document Owner.1.2", type text}}),
		    #"Split Column by Delimiter2" = Table.SplitColumn(#"Changed Type3", "Process Authority", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, true), {"Process Authority.1", "Process Authority.2"}),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Split Column by Delimiter2",{{"Process Authority.1", type text}, {"Process Authority.2", type text}}),
		    #"Split Column by Delimiter3" = Table.SplitColumn(#"Changed Type4", "Process Authority.1", Splitter.SplitTextByEachDelimiter({" "}, QuoteStyle.Csv, true), {"Process Authority.1.1", "Process Authority.1.2"}),
		    #"Changed Type5" = Table.TransformColumnTypes(#"Split Column by Delimiter3",{{"Process Authority.1.1", type text}, {"Process Authority.1.2", type text}}),
		    #"Renamed Columns2" = Table.RenameColumns(#"Changed Type5",{{"Document Owner.1.1", "Document Owner"}, {"Process Authority.1.1", "Process Authority"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns2",{"Document Owner.1.2", "Document Owner.2", "Process Authority.1.2", "Process Authority.2"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Removed Columns",{{"Prioity", "Priority"}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Renamed Columns3",{"Review Priorty"}),
		    #"Duplicated Column4" = Table.DuplicateColumn(#"Removed Other Columns", "Review Priorty", "Review Priorty - Copy"),
		    #"Removed Duplicates" = Table.Distinct(#"Duplicated Column4", {"Review Priorty"}),
		    #"Replaced Value6" = Table.ReplaceValue(#"Removed Duplicates","Greater than 1 year","6",Replacer.ReplaceText,{"Review Priorty - Copy"}),
		    #"Replaced Value7" = Table.ReplaceValue(#"Replaced Value6","Review within 1 year","5",Replacer.ReplaceText,{"Review Priorty - Copy"}),
		    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Value7","Review Overdue","1",Replacer.ReplaceText,{"Review Priorty - Copy"}),
		    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Value8","Review within 30 Days","2",Replacer.ReplaceText,{"Review Priorty - Copy"}),
		    #"Replaced Value10" = Table.ReplaceValue(#"Replaced Value9","Review within 60 Days","3",Replacer.ReplaceText,{"Review Priorty - Copy"}),
		    #"Replaced Value11" = Table.ReplaceValue(#"Replaced Value10","Review within 90 Days","4",Replacer.ReplaceText,{"Review Priorty - Copy"}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Replaced Value11",{{"Review Priorty - Copy", "Review Priority"}, {"Review Priorty", "Review Name"}})
		in
		    #"Renamed Columns4"
	lineageTag: 6488b65d-6606-4ae2-801d-52d42fa88aed

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

/// Sorted Rows table contains columns for Review Status and Priority, which help organize and classify review items by their status and priority level.
expression 'Sorted Rows' =
		let
		    #"Updated JMS Table" = let
		    Source = SharePoint.Tables("https://kbsmaritime.sharepoint.com/sites/JointManagementSystem", [ApiVersion = 15]),
		    #"7a204d33-f1a5-4660-9105-822ef3cfee94" = Source{[Id="7a204d33-f1a5-4660-9105-822ef3cfee94"]}[Items],
		    #"Renamed Columns" = Table.RenameColumns(#"7a204d33-f1a5-4660-9105-822ef3cfee94",{{"ID", "ID.1"}}),
		    #"Removed Columns" = Table.RemoveColumns(#"Renamed Columns",{"CheckoutUser"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Removed Columns",{{"ServerRedirectedEmbedUri", "Document Link"}}),
		    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns1",{"ServerRedirectedEmbedUrl", "ContentTypeId", "FileSystemObjectType", "ComplianceAssetId"}),
		    #"Filtered Rows" = Table.SelectRows(#"Removed Columns1", each ([Title] <> null)),
		    #"Removed Columns2" = Table.RemoveColumns(#"Filtered Rows",{"DocumentOwnerId", "DocumentOwnerStringId", "MethodStatementServiceDeliveryPlan", "OData__Copyright"}),
		    #"Extracted Date" = Table.TransformColumns(#"Removed Columns2",{{"ReviewDate", DateTime.Date, type date}}),
		    #"Removed Columns3" = Table.RemoveColumns(#"Extracted Date",{"URL", "External Ref. Type", "Mgt. Plan Type", "Standard Type", "Strategy Type", "OData__ColorTag", "VControlTableAdded"}),
		    #"Removed Columns4" = Table.RemoveColumns(#"Removed Columns3",{"Mgt. System", "Process AuthorityId", "Process AuthorityStringId", "AuthorId", "OData__CopySource", "CheckoutUserId", "OData__UIVersionString", "GUID", "FirstUniqueAncestorSecurableObject", "RoleAssignments", "AttachmentFiles"}),
		    #"Expanded ContentType" = Table.ExpandRecordColumn(#"Removed Columns4", "ContentType", {"Name"}, {"ContentType.Name"}),
		    #"Renamed Columns3" = Table.RenameColumns(#"Expanded ContentType",{{"ContentType.Name", "Content Type"}}),
		    #"Removed Columns5" = Table.RemoveColumns(#"Renamed Columns3",{"GetDlpPolicyTip"}),
		    #"Expanded FieldValuesAsHtml" = Table.ExpandRecordColumn(#"Removed Columns5", "FieldValuesAsHtml", {"FileLeafRef", "Title"}, {"FieldValuesAsHtml.FileLeafRef", "FieldValuesAsHtml.Title"}),
		    #"Split Column by Delimiter" = Table.SplitColumn(#"Expanded FieldValuesAsHtml", "FieldValuesAsHtml.FileLeafRef", Splitter.SplitTextByDelimiter("-", QuoteStyle.Csv), {"FieldValuesAsHtml.FileLeafRef.1", "FieldValuesAsHtml.FileLeafRef.2", "FieldValuesAsHtml.FileLeafRef.3", "FieldValuesAsHtml.FileLeafRef.4"}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"FieldValuesAsHtml.FileLeafRef.1", Int64.Type}, {"FieldValuesAsHtml.FileLeafRef.2", type text}, {"FieldValuesAsHtml.FileLeafRef.3", type text}, {"FieldValuesAsHtml.FileLeafRef.4", type text}}),
		    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type",{{"FieldValuesAsHtml.FileLeafRef.1", "JMS ID"}}),
		    #"Removed Columns6" = Table.RemoveColumns(#"Renamed Columns4",{"FieldValuesAsHtml.FileLeafRef.2", "FieldValuesAsHtml.FileLeafRef.3", "FieldValuesAsHtml.FileLeafRef.4"}),
		    #"Renamed Columns5" = Table.RenameColumns(#"Removed Columns6",{{"FieldValuesAsHtml.Title", "Document Title"}}),
		    #"Expanded Process Authority" = Table.ExpandRecordColumn(#"Renamed Columns5", "Process Authority", {"Title"}, {"Process Authority.Title"}),
		    #"Renamed Columns6" = Table.RenameColumns(#"Expanded Process Authority",{{"Process Authority.Title", "Process Authority"}}),
		    #"Removed Columns7" = Table.RemoveColumns(#"Renamed Columns6",{"ParentIDLookup", "ID.1", "EditorId"}),
		    #"Removed Columns8" = Table.RemoveColumns(#"Removed Columns7",{"Author", "Editor", "JMSIDLookup", "SharedWithUsers", "TaxCatchAll", "Additional Authorisers"}),
		    #"Expanded DocumentOwner" = Table.ExpandRecordColumn(#"Removed Columns8", "DocumentOwner", {"Title"}, {"DocumentOwner.Title"}),
		    #"Renamed Columns7" = Table.RenameColumns(#"Expanded DocumentOwner",{{"DocumentOwner.Title", "Document Owner"}}),
		    #"Removed Columns9" = Table.RemoveColumns(#"Renamed Columns7",{"Additional AuthorisersId", "Additional AuthorisersStringId", "Eng. Auth. Req'd?", "SHE Auth. Req'd?", "SharedWithUsersId", "SharedWithDetails", "IM Auth. Req'd?", "JMSIDLookupId", "ParentIDLookupId"}),
		    #"Filtered Rows1" = Table.SelectRows(#"Removed Columns9", each true),
		    #"Removed Columns10" = Table.RemoveColumns(#"Filtered Rows1",{"Created", "Modified"}),
		    #"Expanded FieldValuesAsText" = Table.ExpandRecordColumn(#"Removed Columns10", "FieldValuesAsText", {"ProcessID_x003A_Procedure"}, {"FieldValuesAsText.ProcessID_x003A_Procedure"}),
		    #"Renamed Columns8" = Table.RenameColumns(#"Expanded FieldValuesAsText",{{"FieldValuesAsText.ProcessID_x003A_Procedure", "Parent Documrnt Filter"}}),
		    #"Removed Columns11" = Table.RemoveColumns(#"Renamed Columns8",{"JMSReadyTBCComments", "ReviewPeriod", "FieldValuesForEdit", "File", "Folder", "LikedByInformation", "ParentList", "Properties", "Versions"}),
		    #"Added Custom" = Table.AddColumn(#"Removed Columns11", "Days till Review", each DateTime.From([ReviewDate]) - DateTime.LocalNow()),
		    #"Changed Type4" = Table.TransformColumnTypes(#"Added Custom",{{"Days till Review", Int64.Type}}),
		    #"Changed Type3" = Table.TransformColumnTypes(#"Changed Type4",{{"ReviewDate", type datetime}}),
		    #"Changed Type2" = Table.TransformColumnTypes(#"Changed Type3",{{"Days till Review", type duration}}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Changed Type2",{{"ReviewDate", type date}, {"Days till Review", Int64.Type}}),
		    #"Added Custom1" = Table.AddColumn(#"Changed Type1", "Status", each if [Days till Review] < 0 then "Expired"
		  else if [Days till Review] >= 0 and [Days till Review] < 30 then "Expires within 30 Days"
		  else if [Days till Review] >= 30 and [Days till Review] < 60 then "Expires within 60 Days"
		  else if [Days till Review] >= 60 and [Days till Review] < 180 then "Expires within 180 Days"
		  else "Expires within 180+ Days"),
		    #"Renamed Columns9" = Table.RenameColumns(#"Added Custom1",{{"Status", "Review Status"}}),
		    #"Added Custom2" = Table.AddColumn(#"Renamed Columns9", "Custom", each if [Days till Review] < 0 then "Review Overdue"
		  else if [Days till Review] >= 0 and [Days till Review] < 30 then "Review within 30 Days"
		  else if [Days till Review] >= 30 and [Days till Review] < 60 then "Review within 60 Days"
		  else if [Days till Review] >= 60 and [Days till Review] < 90 then "Review within 90 Days"
		  else if [Days till Review] < 365 then "Review within 1 year"
		  else "Greater than 1 year"),
		    #"Renamed Columns10" = Table.RenameColumns(#"Added Custom2",{{"Custom", "Review Priorty"}}),
		    #"Added Custom3" = Table.AddColumn(#"Renamed Columns10", "Custom", each if [JMS ID] >= 10000 and [JMS ID] <= 10999 then "10K"
		  else if [JMS ID] >= 15000 and [JMS ID] <= 15999 then "15K"
		  else if [JMS ID] >= 30000 then "30K"
		  else null),
		    #"Renamed Columns11" = Table.RenameColumns(#"Added Custom3",{{"Custom", "10k or 30K"}}),
		    #"Duplicated Column" = Table.DuplicateColumn(#"Renamed Columns11", "Review Status", "Review Status - Copy")
		in
		    #"Renamed Columns11",
		    #"Filtered Rows" = Table.SelectRows(#"Updated JMS Table", each ([ReviewDate] <> null)),
		    #"Duplicated Column" = Table.DuplicateColumn(#"Filtered Rows", "Review Status", "Review Status - Copy"),
		    #"Replaced Value" = Table.ReplaceValue(#"Duplicated Column","Expires within 180+ Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","Expires within 60 Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Expires within 180 Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","Expires within 30 Days","Compliant",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Renamed Columns" = Table.RenameColumns(#"Replaced Value3",{{"Review Status - Copy", "Compliant and Expired"}}),
		    #"Changed Type" = Table.TransformColumnTypes(#"Renamed Columns",{{"Compliant and Expired", type text}}),
		    #"Duplicated Column1" = Table.DuplicateColumn(#"Changed Type", "Compliant and Expired", "Compliant and Expired - Copy"),
		    #"Replaced Value4" = Table.ReplaceValue(#"Duplicated Column1","Compliant","2",Replacer.ReplaceText,{"Compliant and Expired - Copy"}),
		    #"Replaced Value5" = Table.ReplaceValue(#"Replaced Value4","Expired","1",Replacer.ReplaceText,{"Compliant and Expired - Copy"}),
		    #"Changed Type1" = Table.TransformColumnTypes(#"Replaced Value5",{{"Compliant and Expired - Copy", Int64.Type}}),
		    #"Removed Other Columns" = Table.SelectColumns(#"Changed Type1",{"Review Status"}),
		    #"Duplicated Column2" = Table.DuplicateColumn(#"Removed Other Columns", "Review Status", "Review Status - Copy"),
		    #"Replaced Value6" = Table.ReplaceValue(#"Duplicated Column2","Expires within 180+ Days","1",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value7" = Table.ReplaceValue(#"Replaced Value6","Expired","5",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value8" = Table.ReplaceValue(#"Replaced Value7","Expires within 180 Days","2",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value9" = Table.ReplaceValue(#"Replaced Value8","Expires within 60 Days","3",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Replaced Value10" = Table.ReplaceValue(#"Replaced Value9","Expires within 30 Days","4",Replacer.ReplaceText,{"Review Status - Copy"}),
		    #"Renamed Columns1" = Table.RenameColumns(#"Replaced Value10",{{"Review Status - Copy", "Priority"}}),
		    #"Removed Duplicates" = Table.Distinct(#"Renamed Columns1", {"Review Status"})
		in
		    #"Removed Duplicates"
	lineageTag: 2fc90d66-71c9-480a-b368-4ef9ce083855

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

expression StartDate = #date(2021, 10, 1) meta [IsParameterQuery=true, Type="Date", IsParameterQueryRequired=true]
	lineageTag: b164202e-9623-4189-994a-be0fd369b3cd

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Date

expression EndDate = #date(2036, 12, 31) meta [IsParameterQuery=true, Type="Date", IsParameterQueryRequired=true]
	lineageTag: 007e1e53-cf51-4591-966b-81286fc2fea5

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Date

expression 'Errors in JMS Table' =
		let
		Source = #"JMS Table",
		  #"Detected Type Mismatches" = let
		    tableWithOnlyPrimitiveTypes = Table.SelectColumns(Source, Table.ColumnsOfType(Source, {type nullable number, type nullable text, type nullable logical, type nullable date, type nullable datetime, type nullable datetimezone, type nullable time, type nullable duration})),
		    recordTypeFields = Type.RecordFields(Type.TableRow(Value.Type(tableWithOnlyPrimitiveTypes))),
		    fieldNames = Record.FieldNames(recordTypeFields),
		    fieldTypes = List.Transform(Record.ToList(recordTypeFields), each [Type]),
		    pairs = List.Transform(List.Positions(fieldNames), (i) => {fieldNames{i}, (v) => if v = null or Value.Is(v, fieldTypes{i}) then v else error [Message = "The type of the value does not match the type of the column.", Detail = v], fieldTypes{i}})
		in
		    Table.TransformColumns(Source, pairs),
		  #"Added Index" = Table.AddIndexColumn(#"Detected Type Mismatches", "Row Number" ,1),
		  #"Kept Errors" = Table.SelectRowsWithErrors(#"Added Index", {"Business Area L1", "Document Owner", "Process Authority", "Title", "Id", "Document Owner Id", "Parent ID Lookup Id", "Quality Team Comments", "Continual Improvement Required", "Created", "ReviewDate", "AuthorId", "Modified", "Editor Id", "Content Type", "JMS ID", "Review Date", "10K or 30K", "Review Priority", "Review Status", "Days till Review", "Priority Score", "Priority", "Compliant and Expired", "Sort DO", "Sort PA", "Compliant and Expired - Copy", "Document Link", "Owners Email", "Review Status Signs", "Review Priority Signs"})
		in
		    #"Kept Errors"
	lineageTag: e55cea2c-c0c4-4ce1-a01a-f2f5a26b84bb
	queryGroup: 'Query Errors - 02/02/2026 19:05:05'

	annotation PBI_NavigationStepName = Navigation

	annotation PBI_ResultType = Table

